(function(b){b.fn.FacebookAlbumBrowser=function(u){var d=b.extend({},{account:"",accessToken:"",showAccountInfo:!0,showImageCount:!0,skipEmptyAlbums:!0,showComments:!0,commentsLimit:5,skipAlbums:[],includeAlbums:[],onlyAlbum:null,thumbnailSize:120,showAlbumNameInPreview:!0,lightbox:!0,photosCheckbox:!0,albumSelected:null,photoSelected:null,photoChecked:null,photoUnchecked:null,showImageText:!1,likeButton:!0,shareButton:!0,addThis:null,pluginImagesPath:"assets/img/",albumsPageSize:0,albumsMoreButtonText:"more albums...",
photosPageSize:0,photosMoreButtonText:"more photos...",checkedPhotos:[]},u),l=b(this);l.each(function(q){function z(g){b(r).addClass("fb-loading-image");b.ajax({type:"GET",url:g,cache:!1,dataType:"jsonp",success:function(e){if(0<b(e.data).length){if(null!=d.albumsPageSize&&0<d.albumsPageSize){var f=b(p).find(".fb-btn-more");0==f.length&&(f=b("<div>",{"class":"fb-btn-more fb-albums-more",text:d.albumsMoreButtonText}),b(p).append(f),b(f).click(function(){var e=b(this);b(p).find("li.fb-album:hidden").slice(0,
d.albumsPageSize).fadeIn(function(){0==b(p).find("li.fb-album:hidden").length&&e.fadeOut(function(){e.remove()})})}))}for(a=0;a<b(e.data).length;a++)if(!(0<d.skipAlbums.length&&(-1<d.skipAlbums.indexOf(b(e.data).get(a).name)||-1<d.skipAlbums.indexOf(b(e.data).get(a).id.toString()))||0<d.includeAlbums.length&&0>d.includeAlbums.indexOf(b(e.data).get(a).name)&&0>d.includeAlbums.indexOf(b(e.data).get(a).id.toString())||(f=b("<li>",{"class":"fb-album","data-id":b(e.data).get(a).id,style:"height:"+d.thumbnailSize+
"px ; width:"+d.thumbnailSize+"px "}),null==b(e.data).get(a).count&&d.skipEmptyAlbums))){var g=b(e.data).get(a).cover_photo,k="https://graph.facebook.com/";"undefined"!=typeof g&&(k=isNaN(g)?k+g.id:k+g);""!=d.accessToken&&(k+="?access_token="+d.accessToken+"&fields=id,created_time,from,height,icon,images,link,name,picture,updated_time,width,source");b.ajax({type:"GET",url:k,cache:!1,data:{album:b(e.data).get(a).id},dataType:"jsonp",success:function(d){var e=b("li.fb-album[data-id='"+
C("album",b(this).get(0).url)+"'] ");if(!b(d).get(0).error&&b(d).get(0).images){var f=e.width(),m=e.height(),g=b(d.images)[0];for(i=0;i<b(d.images).length;i++)b(d.images)[i].height>=m&&b(d.images)[i].width>=f&&b(d.images)[i].height<=g.height&&b(d.images)[i].width<=g.width&&(g=b(d.images)[i]);d=b("<img>",{style:"margin-left:"+(f-g.width)/2+"px; display:none;","data-id":b(d).get(0).id,"class":"fb-album-thumb","data-src":g.source,src:""});e.append(d);b(d).load(function(){b(this).fadeIn(300)});t(d);A()}else e.remove()}});
f.append(b("<div>",{"class":"fb-album-title",text:b(e.data).get(a).name}));d.showImageCount&&f.append(b("<div>",{"class":"fb-album-count",text:b(e.data).get(a).count}));b(r).append(f);b(r).removeClass("fb-loading-image");0<d.albumsPageSize&&b(r).find("li").index(f)>=d.albumsPageSize&&(f.hide(),b(p).find(".fb-albums-more").fadeIn());b(f).click(function(){var e=b(this);b(l).append(b("<div>",{"class":"fb-album-preview"}));b(l).find("div.fb-albums-more").hide();var f=l.find(".fb-album-preview");f.append(b("<img>",
{alt:"",height:32,width:32,src:d.pluginImagesPath+"back.png","class":"fb-albums-list"}));b(f).append(b("<ul>",{"class":"fb-photos",style:"min-height:"+d.thumbnailSize+"px "}));photosContainer=b(f).find("ul.fb-photos");var g="https://graph.facebook.com/"+b(e).attr("data-id")+"/photos";""!=d.accessToken&&(g+="?access_token="+d.accessToken+"&fields=id,created_time,from,height,icon,images,link,name,picture,updated_time,width,source");null!=d.albumSelected&&"function"==typeof d.albumSelected&&
d.albumSelected({id:b(e).attr("data-id"),url:g,thumb:b(e).find("img.fb-album-thumb").attr("src")});v(g,photosContainer);b(l).find("ul.fb-albums").fadeOut(function(){f.fadeIn()})});b(f).hover(function(){var d=b(this),e=d.find("div.fb-album-title").height();d.find("div.fb-album-title").slideDown({duration:300,easing:"linear"});d.find("div.fb-album-count").css({top:e+10+"px"})},function(){var d=b(this);d.find("div.fb-album-title").slideUp({duration:300,easing:"linear"});d.find("div.fb-album-count").css({top:"0"})})}e.paging&&
e.paging.next&&""!=e.paging.next&&z(e.paging.next)}}})}function v(g,e){b(e).addClass("fb-loading-image");var f=e.parent();e.hasClass("fb-album-container")&&(f=e);if(0==f.find(".fb-photo").length){var h=f.find("img.fb-albums-list"),k=b("<h3>",{"class":"fb-album-heading",text:""});0<h.length?h.after(k):(h=f.find(".fb-account-info"),0<h.length?(h.after(k),k.addClass("fb-album-heading-single")):f.prepend(k));null==d.onlyAlbum&&f.find("img.fb-albums-list,h3.fb-album-heading").click(function(){f.fadeOut(function(){b(l).find(".fb-albums").fadeIn(function(){0<
d.albumsPageSize&&0<b(l).find("li.fb-album:hidden").length&&b(l).find("div.fb-albums-more").show()});f.remove()})});d.showAlbumNameInPreview&&b.ajax({type:"GET",url:g.replace("/photos","/").replace("&fields=id,created_time,from,height,icon,images,link,name,picture,updated_time,width,source","&fields=name"),cache:!1,dataType:"jsonp",success:function(b){null!=b&&f.find(".fb-album-heading").text(b.name)}})}b.ajax({type:"GET",url:g,cache:!1,dataType:"jsonp",success:function(f){if(0<f.data.length){if(null!=
d.photosPageSize&&0<d.photosPageSize){var g=b(e).parent().find(".fb-btn-more");0==g.length&&(g=b("<div>",{"class":"fb-btn-more fb-photos-more",text:d.photosMoreButtonText}),b(e).parent().append(g),b(g).click(function(){var f=b(this);b(e).find("li.fb-photo:hidden").slice(0,d.photosPageSize).fadeIn(function(){0==b(e).find("li.fb-photo:hidden").length&&f.fadeOut(function(){f.remove()})})}))}for(a=0;a<f.data.length;a++){g=b("<li>",{"class":"fb-photo",style:"height:"+d.thumbnailSize+"px ; width:"+
d.thumbnailSize+"px "});var k=g.width(),h=g.height(),m=b(f.data)[a].images[0];for(i=0;i<b(f.data)[a].images.length;i++)b(f.data)[a].images[i].height>=h&&b(f.data)[a].images[i].width>=k&&b(f.data)[a].images[i].height<=m.height&&b(f.data)[a].images[i].width<=m.width&&(m=b(f.data)[a].images[i]);h=b("<a>",{"class":"fb-photo-thumb-link",href:b(f.data)[a].source,"data-fb-page":b(f.data)[a].link});var l=0;0<k&&(l=(k-m.width)/2);if(d.photosCheckbox){var w=b("<div>",{"class":"image-check"});w.click(function(){var e=
{id:b(this).parent().find("img.fb-photo-thumb").attr("data-id"),url:b(this).parent().find("a").attr("href"),thumb:b(this).parent().find("img.fb-photo-thumb").attr("src")};b(this).toggleClass("checked");if(b(this).hasClass("checked"))null!=d.photoChecked&&"function"==typeof d.photoChecked&&(d.checkedPhotos.push(e),d.photoChecked(e));else if(null!=d.photoUnchecked&&"function"==typeof d.photoUnchecked)for(i=0;i<d.checkedPhotos.length;i++)if(d.checkedPhotos[i].id==e.id){d.checkedPhotos.splice(i,1);d.photoUnchecked(e);
break}return!1})}k=b("<img>",{style:"margin-left:"+l+"px;display:none;","data-id":b(f.data).get(a).id,"class":"fb-photo-thumb","data-src":m.source,src:""});m=b("<span>",{"class":"fb-photo-text"});m.text(b(f.data).get(a).name);h.append(m);h.append(k);if(d.photosCheckbox)for(g.append(w),i=0;i<d.checkedPhotos.length;i++)if(d.checkedPhotos[i].id==b(f.data).get(a).id){w.addClass("checked");break}g.append(h);e.append(g);b(e).removeClass("fb-loading-image");0<d.photosPageSize&&b(e).find("li").index(g)>=
d.photosPageSize&&(g.hide(),b(e).find(".fb-photos-more").fadeIn());b(k).load(function(){b(this).fadeIn(300)});t(k);D(e.find("a.fb-photo-thumb-link"))}f.paging&&f.paging.next&&""!=f.paging.next&&v(f.paging.next,e)}}})}function B(g,e,f){var h="https://graph.facebook.com/"+g+"/comments?access_token="+d.accessToken+"&limit="+d.commentsLimit;null!=f?h=f:(b(e).find(".fb-comment").remove(),b(e).find(".fb-comment-more").remove());b.ajax({type:"GET",url:h,cache:!1,dataType:"jsonp",success:function(d){if(0<
d.data.length){if(""!=d.paging.next){var h=b(e).find(".fb-comment-more");0==h.length&&(h=b("<div/>",{"class":"fb-comment-more",text:"more"}),b(e).append(h));b(h).unbind("click");b(h).attr("data-next",d.paging.next);b(h).click(function(){B(g,e,b(this).attr("data-next"));return!1})}else b(e).find(".fb-comment-more").remove();b(h).css("maxWidth",e.find(".fb-preview-img").width()-12);for(c=0;c<d.data.length;c++){var k="https://graph.facebook.com/"+b(d.data)[c].from.id+"/picture?type=square",l=b("<div/>",
{"class":"fb-comment"});l.css("maxWidth",e.find(".fb-preview-img").width()-12);l.append(b("<img/>",{src:k,"class":"fb-comment-account"}));k=b("<div/>",{"class":"fb-comment-text"});k.append(b("<a/>",{"class":"fb-comment-account",target:"_blank",href:"",text:b(d.data)[c].from.name}));k.append(b("<div/>",{"class":"fb-comment-date",text:E(b(d.data)[c].created_time).toLocaleString()}));k.append(b("<div/>",{text:b(d.data)[c].message}));l.append(k);h.before(l)}null==
f?b(document).scrollTop():b(".fb-preview-overlay").animate({scrollTop:b(e).find(".fb-comment").last().offset().top},1E3)}}})}function t(d){var e=null;b(d).hasClass("fb-photo-thumb")?e=b(d).parent().parent():b(d).hasClass("fb-album-thumb")&&(e=b(d).parent());if(null!=e){e=b(e);e=b(e);var f=b(window);f=f.scrollTop()+f.height();var g=e.offset().top;e.height();if(g<=f&&""==b(d).attr("src"))b(d).attr("src",b(d).attr("data-src")),b(d).removeAttr("data-src");else return!1}return!0}function A(){b(window).scroll(function(){b(".fb-album-thumb[src='']").each(function(){return t(b(this))});
b(".fb-photo-thumb[src='']").each(function(){return t(b(this))})})}function u(g){var e=b("<div>",{"class":"fb-account-info"}),f=b("<a>",{target:"_blank",href:""});e.append(f);f.append(b("<img>",{src:"https://graph.facebook.com/"+d.account+"/picture?type=square"}));f.append(b("<h3>",{"class":"fb-account-heading"}));b(g).append(e);e="https://graph.facebook.com/"+d.account;""!=d.accessToken&&(e+="?access_token="+d.accessToken);b.ajax({type:"GET",url:e,cache:!1,dataType:"jsonp",success:function(d){b(g).find(".fb-account-info").find(".fb-account-heading").text(d.name);
b(g).find(".fb-account-info").find("a").attr("href","")}})}function x(g,e){if(d.likeButton){var f=b("<div>",{"data-show-faces":"false","class":"fb-like","data-href":e,"data-action":"like","data-layout":"box_count","data-share":d.shareButton}),h=b("<div>",{"class":"fb-like-container"});h.append(f);g.prepend(h);FB.XFBML.parse()}if(d.shareButton&&null!=d.addThis&&""!=d.addThis){f=b("<div>",{"data-url":e,"class":"addthis_toolbox addthis_default_style"});
for(btn=1;4>=btn;btn++)f.append(b("<a>",{"class":"addthis_button_preferred_"+btn}));f.append(b("<a>",{"class":"addthis_button_compact"}));f.append(b("<a>",{"class":"addthis_counter addthis_bubble_style"}));g.append(f);"undefined"===typeof addthis?b.getScript("//s7.addthis.com/js/300/addthis_widget.js#pubid="+d.addThis,function(){addthis.update("share","url",e);addthis.toolbox(".addthis_toolbox")}):(addthis.update("share","url",e),addthis.toolbox(".addthis_toolbox"))}}function D(g){var e=b(".fb-preview-overlay");
if(0==e.length){e=b("<div>",{"class":"fb-preview-overlay"});var f=b("<div>",{"class":"fb-preview-content"});e.append(f);f.append(b("<img>",{"class":"fb-preview-img"}));(d.showImageText||d.likeButton||d.shareButton)&&f.append(b("<div>",{"class":"fb-preview-text"}));e.append(b("<img>",{"class":"fb-preview-img-prev",src:d.pluginImagesPath+"prev-icon.png"}));e.append(b("<img>",{"class":"fb-preview-img-next",src:d.pluginImagesPath+"next-icon.png"}));b("body").append(e);e=b(".fb-preview-overlay");b(e).click(function(){b(this).fadeOut()});
b(e).find(".fb-preview-img").click(function(){b(this).parent().find("img.fb-preview-img-next").click();return!1});d.likeButton&&(b("body").append("<div>",{id:"fb-root"}),function(b,d,e){var f=b.getElementsByTagName(d)[0];b.getElementById(e)||(b=b.createElement(d),b.id=e,b.src="//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3&appId=775908159169504",f.parentNode.insertBefore(b,f))}(document,"script","facebook-jssdk"))}else e=b(".fb-preview-overlay");b(g).unbind("click");b(g).click(function(e){var f=
b(".fb-preview-text"),g=b(".fb-preview-content");g.hide();d.showImageText&&f.html(y(b(this).find(".fb-photo-text").text()));x(f,b(this).attr("data-fb-page"));var h={id:b(this).find("img.fb-photo-thumb").attr("data-id"),url:b(this).attr("href"),thumb:b(this).find("img.fb-photo-thumb").attr("data-id")};null!=d.photoSelected&&"function"==typeof d.photoSelected&&d.photoSelected(h);if(d.lightbox){var l=b(".fb-preview-overlay"),n=l.find("img.fb-preview-img");n.hide();l.find("img.fb-preview-img-prev,img.fb-preview-img-next").hide();
n.attr("data-id",b(this).find("img.fb-photo-thumb").attr("data-id"));n.attr("src",b(this).attr("href"));/chrom(e|ium)/.test(navigator.userAgent.toLowerCase())&&b(n).show();n.unbind("load");n.load(function(){g.css("display","block");""!=f.text().trim()||d.likeBtn?f.css("display","block"):f.hide();f.css("maxWidth",b(this).width()-12);f.css("minWidth",b(this).width()-12);b(".fb-comment,.fb-comment-more").css("maxWidth",b(this).width()-12);b(this).show();d.showComments&&B(b(this).attr("data-id"),b(this).parent(),
null);var e=l.find("img.fb-preview-img-prev");e.show();e.unbind("click");e.click(function(){var e=b(this).parent().find(".fb-preview-content");e=b(e).find(".fb-preview-img");e=b("[href='"+e.attr("src")+"']");if(0!=e.length){var h=e.parent().prev();e=0!=h.length?h.find(".fb-photo-thumb-link"):e.parent().parent().find("li").last().find(".fb-photo-thumb-link");n.attr("data-id",e.find("img.fb-photo-thumb").attr("data-id"));n.attr("src",e.attr("href"));g.hide();d.showImageText&&f.html(y(e.text()));x(f,
e.attr("data-fb-page"))}return!1});var h=l.find("img.fb-preview-img-next");h.show();h.unbind("click");h.click(function(){var e=b(this).parent().find(".fb-preview-content");e=b(e).find(".fb-preview-img");e=b("[href='"+e.attr("src")+"']");if(0!=e.length){var h=e.parent().next();e=0!=h.length?h.find(".fb-photo-thumb-link"):e.parent().parent().find("li").first().find(".fb-photo-thumb-link");n.attr("data-id",e.find("img.fb-photo-thumb").attr("data-id"));n.attr("src",e.attr("href"));g.hide();d.showImageText&&
f.html(y(e.text()));x(f,e.attr("data-fb-page"))}return!1});b(document).unbind("keypress");b(document).keypress(function(d){switch(d.keyCode?d.keyCode:d.which){case 37:d.preventDefault();b(e).click();break;case 39:d.preventDefault();b(h).click();break;case 27:d.preventDefault(),b(l).click()}});b(this).fadeIn()});l.fadeIn();e.preventDefault();e.stopPropagation();return!1}})}function E(b){var d=b.split("T")[0];b=b.split("T")[1].substring(0,8);return new Date(Date.UTC(d.split("-")[0],d.split("-")[1],
d.split("-")[2],b.split(":")[0],b.split(":")[1],b.split(":")[2]))}function y(b){return b.replace(/(https?:\/\/([-\w\.]+)+(:\d+)?(\/([\w\/_\.]*(\?\S+)?)?)?)/ig,"<a href='$1' target='_blank'>$1</a>")}function C(b,d){b=b.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var e=(new RegExp("[\\?&]"+b+"=([^&#]*)")).exec(d);return null==e?"":decodeURIComponent(e[1].replace(/\+/g," "))}var p=l.get(q);q="";d.showAccountInfo&&u(p);null==d.onlyAlbum?(b(p).append(b("<ul>",{"class":"fb-albums",style:"min-height:"+d.thumbnailSize+
"px "})),q="https://graph.facebook.com/"+d.account+"/albums",""!=d.accessToken&&(q+="?access_token="+d.accessToken+"&fields=id,count,cover_photo,created_time,from,link,name,type,updated_time")):(q="https://graph.facebook.com/"+d.onlyAlbum+"/photos",""!=d.accessToken&&(q+="?access_token="+d.accessToken+"&fields=id,created_time,from,height,icon,images,link,name,picture,updated_time,width,source"));var r=b(p).find(".fb-albums");null!=d.onlyAlbum?(v(q,b(p)),A()):z(q)});return this}})(jQuery);